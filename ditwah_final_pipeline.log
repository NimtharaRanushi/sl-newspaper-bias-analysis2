2026-01-30 11:38:11,307 - INFO - Version: ditwah-v2-per-article
2026-01-30 11:38:11,308 - INFO - Description: Ditwah claims generated from each individual article (min 5 articles per claim, with sentiment + stance)
2026-01-30 11:38:11,308 - INFO - Analysis type: ditwah_claims
2026-01-30 11:38:11,308 - INFO - Min articles per claim: 5
2026-01-30 11:38:11,308 - INFO - LLM provider: mistral
2026-01-30 11:38:11,308 - INFO - LLM model: mistral-large-latest
2026-01-30 11:38:11,308 - INFO - 
Starting BATCHED claims generation pipeline...
2026-01-30 11:38:11,308 - INFO - This will:
2026-01-30 11:38:11,309 - INFO -   1. Process articles in batches of 50
2026-01-30 11:38:11,309 - INFO -   2. Generate claims from each batch
2026-01-30 11:38:11,309 - INFO -   3. Merge and deduplicate claims
2026-01-30 11:38:11,309 - INFO -   4. Filter claims with < 5 articles
2026-01-30 11:38:11,309 - INFO -   5. Analyze sentiment and stance for all claims
2026-01-30 11:38:11,310 - INFO -   6. Keep only claims with BOTH sentiment and stance data

2026-01-30 11:38:11,319 - INFO - Starting batched Ditwah claims pipeline for version ef6bf730-8ab4-4089-8c86-45a4ef9a09b6
2026-01-30 11:38:11,416 - INFO - Found 1657 Ditwah articles
2026-01-30 11:38:11,420 - INFO - Processing 1657 Ditwah articles in batches
2026-01-30 11:38:12,636 - INFO - Processing batch 1/34 (50 articles)...
2026-01-30 11:38:41,225 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:38:41,228 - INFO -   Batch 1: Extracted 29 claims
2026-01-30 11:38:41,228 - INFO - Processing batch 2/34 (50 articles)...
2026-01-30 11:39:07,336 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:39:07,341 - INFO -   Batch 2: Extracted 26 claims
2026-01-30 11:39:07,341 - INFO - Processing batch 3/34 (50 articles)...
2026-01-30 11:39:36,770 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:39:36,772 - INFO -   Batch 3: Extracted 29 claims
2026-01-30 11:39:36,772 - INFO - Processing batch 4/34 (50 articles)...
2026-01-30 11:40:08,334 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:40:08,349 - INFO -   Batch 4: Extracted 26 claims
2026-01-30 11:40:08,349 - INFO - Processing batch 5/34 (50 articles)...
2026-01-30 11:40:40,639 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:40:40,640 - INFO -   Batch 5: Extracted 28 claims
2026-01-30 11:40:40,641 - INFO - Processing batch 6/34 (50 articles)...
2026-01-30 11:41:08,249 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:41:08,252 - INFO -   Batch 6: Extracted 30 claims
2026-01-30 11:41:08,252 - INFO - Processing batch 7/34 (50 articles)...
2026-01-30 11:41:41,995 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:41:42,012 - INFO -   Batch 7: Extracted 32 claims
2026-01-30 11:41:42,013 - INFO - Processing batch 8/34 (50 articles)...
2026-01-30 11:42:14,481 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:42:14,484 - INFO -   Batch 8: Extracted 34 claims
2026-01-30 11:42:14,484 - INFO - Processing batch 9/34 (50 articles)...
2026-01-30 11:42:58,437 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:42:58,440 - INFO -   Batch 9: Extracted 30 claims
2026-01-30 11:42:58,440 - INFO - Processing batch 10/34 (50 articles)...
2026-01-30 11:43:34,040 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:43:34,043 - INFO -   Batch 10: Extracted 24 claims
2026-01-30 11:43:34,043 - INFO - Processing batch 11/34 (50 articles)...
2026-01-30 11:44:02,376 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:44:02,380 - INFO -   Batch 11: Extracted 30 claims
2026-01-30 11:44:02,380 - INFO - Processing batch 12/34 (50 articles)...
2026-01-30 11:44:44,160 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:44:44,162 - INFO -   Batch 12: Extracted 30 claims
2026-01-30 11:44:44,162 - INFO - Processing batch 13/34 (50 articles)...
2026-01-30 11:45:14,758 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:45:14,762 - INFO -   Batch 13: Extracted 30 claims
2026-01-30 11:45:14,762 - INFO - Processing batch 14/34 (50 articles)...
2026-01-30 11:45:46,393 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:45:46,396 - INFO -   Batch 14: Extracted 31 claims
2026-01-30 11:45:46,396 - INFO - Processing batch 15/34 (50 articles)...
2026-01-30 11:46:22,785 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:46:22,789 - INFO -   Batch 15: Extracted 35 claims
2026-01-30 11:46:22,789 - INFO - Processing batch 16/34 (50 articles)...
2026-01-30 11:46:59,766 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:46:59,778 - INFO -   Batch 16: Extracted 29 claims
2026-01-30 11:46:59,778 - INFO - Processing batch 17/34 (50 articles)...
2026-01-30 11:47:34,705 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:47:34,707 - INFO -   Batch 17: Extracted 32 claims
2026-01-30 11:47:34,707 - INFO - Processing batch 18/34 (50 articles)...
2026-01-30 11:48:09,001 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:48:09,014 - INFO -   Batch 18: Extracted 29 claims
2026-01-30 11:48:09,014 - INFO - Processing batch 19/34 (50 articles)...
2026-01-30 11:48:45,626 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:48:45,630 - INFO -   Batch 19: Extracted 26 claims
2026-01-30 11:48:45,630 - INFO - Processing batch 20/34 (50 articles)...
2026-01-30 11:49:20,995 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:49:20,997 - INFO -   Batch 20: Extracted 27 claims
2026-01-30 11:49:20,997 - INFO - Processing batch 21/34 (50 articles)...
2026-01-30 11:49:53,489 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:49:53,493 - INFO -   Batch 21: Extracted 26 claims
2026-01-30 11:49:53,493 - INFO - Processing batch 22/34 (50 articles)...
2026-01-30 11:50:30,849 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:50:30,853 - INFO -   Batch 22: Extracted 31 claims
2026-01-30 11:50:30,853 - INFO - Processing batch 23/34 (50 articles)...
2026-01-30 11:51:03,319 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:51:03,323 - INFO -   Batch 23: Extracted 25 claims
2026-01-30 11:51:03,323 - INFO - Processing batch 24/34 (50 articles)...
2026-01-30 11:51:39,855 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:51:39,857 - INFO -   Batch 24: Extracted 30 claims
2026-01-30 11:51:39,858 - INFO - Processing batch 25/34 (50 articles)...
2026-01-30 11:52:19,015 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:52:19,017 - INFO -   Batch 25: Extracted 31 claims
2026-01-30 11:52:19,017 - INFO - Processing batch 26/34 (50 articles)...
2026-01-30 11:52:44,187 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:52:44,191 - INFO -   Batch 26: Extracted 26 claims
2026-01-30 11:52:44,191 - INFO - Processing batch 27/34 (50 articles)...
2026-01-30 11:53:23,471 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:53:23,474 - INFO -   Batch 27: Extracted 35 claims
2026-01-30 11:53:23,474 - INFO - Processing batch 28/34 (50 articles)...
2026-01-30 11:54:02,651 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:54:02,653 - INFO -   Batch 28: Extracted 29 claims
2026-01-30 11:54:02,653 - INFO - Processing batch 29/34 (50 articles)...
2026-01-30 11:54:41,624 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:54:41,627 - INFO -   Batch 29: Extracted 29 claims
2026-01-30 11:54:41,627 - INFO - Processing batch 30/34 (50 articles)...
2026-01-30 11:55:14,779 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:55:14,782 - INFO -   Batch 30: Extracted 25 claims
2026-01-30 11:55:14,782 - INFO - Processing batch 31/34 (50 articles)...
2026-01-30 11:55:39,628 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:55:39,631 - INFO -   Batch 31: Extracted 24 claims
2026-01-30 11:55:39,631 - INFO - Processing batch 32/34 (50 articles)...
2026-01-30 11:56:11,944 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:56:11,946 - INFO -   Batch 32: Extracted 26 claims
2026-01-30 11:56:11,946 - INFO - Processing batch 33/34 (50 articles)...
2026-01-30 11:56:43,458 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:56:43,460 - INFO -   Batch 33: Extracted 28 claims
2026-01-30 11:56:43,460 - INFO - Processing batch 34/34 (7 articles)...
2026-01-30 11:56:54,975 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:56:54,977 - INFO -   Batch 34: Extracted 16 claims
2026-01-30 11:56:54,978 - INFO - ✅ Generated 968 raw claims from 34 batches
2026-01-30 11:56:54,978 - INFO - Merging 968 claims...
2026-01-30 11:56:54,983 - INFO - Merged to 963 unique claims
2026-01-30 11:56:58,612 - INFO - Note: NumExpr detected 12 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2026-01-30 11:56:58,613 - INFO - NumExpr defaulting to 8 threads.
2026-01-30 11:57:00,518 - INFO - Deduplicating 963 claims with embeddings (threshold=0.85)...
/home/ranushi/anaconda3/lib/python3.11/site-packages/torch/cuda/__init__.py:182: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 804: forward compatibility was attempted on non supported HW (Triggered internally at /pytorch/c10/cuda/CUDAFunctions.cpp:119.)
  return torch._C._cuda_getDeviceCount() > 0
2026-01-30 11:57:00,566 - INFO - Use pytorch device_name: cpu
2026-01-30 11:57:00,566 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2026-01-30 11:57:05,560 - INFO - Processing 175 claims in category: infrastructure_damage
2026-01-30 11:57:06,173 - INFO -   Category infrastructure_damage: 175 → 136 claims
2026-01-30 11:57:06,174 - INFO - Processing 143 claims in category: casualties_and_displacement
2026-01-30 11:57:06,607 - INFO -   Category casualties_and_displacement: 143 → 73 claims
2026-01-30 11:57:06,608 - INFO - Processing 160 claims in category: government_response
2026-01-30 11:57:07,125 - INFO -   Category government_response: 160 → 143 claims
2026-01-30 11:57:07,125 - INFO - Processing 212 claims in category: international_response
2026-01-30 11:57:08,100 - INFO -   Category international_response: 212 → 153 claims
2026-01-30 11:57:08,101 - INFO - Processing 150 claims in category: humanitarian_aid
2026-01-30 11:57:09,120 - INFO -   Category humanitarian_aid: 150 → 127 claims
2026-01-30 11:57:09,120 - INFO - Processing 123 claims in category: economic_impact
2026-01-30 11:57:09,865 - INFO -   Category economic_impact: 123 → 109 claims
2026-01-30 11:57:09,865 - INFO - Deduplicated to 741 unique claims
2026-01-30 11:57:09,865 - INFO - Filtered 741 claims to 44 claims with >=5 articles
2026-01-30 11:57:09,866 - INFO - ✅ 44 claims passed filters
2026-01-30 11:57:09,906 - INFO - Stored 44 claims
2026-01-30 11:57:09,910 - INFO - Analyzing claim 1/44: Cyclone Ditwah intensified from a deep depression near Sri L...
2026-01-30 11:57:09,972 - INFO -   Sentiment: 10 records
2026-01-30 11:57:09,999 - ERROR - Pipeline failed with error: operator does not exist: uuid = text
LINE 4:                     WHERE id = ANY(ARRAY['fb00af4f-e54f-4771...
                                     ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
Traceback (most recent call last):
  File "/home/ranushi/Taf_claude/sl-newspaper-bias-analysis/scripts/ditwah_claims/04_generate_claims_batched.py", line 81, in main
    summary = generate_claims_pipeline_batched(version_id, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ranushi/Taf_claude/sl-newspaper-bias-analysis/src/ditwah_claims_batched.py", line 593, in generate_claims_pipeline_batched
    cur.execute(f"""
  File "/home/ranushi/anaconda3/lib/python3.11/site-packages/psycopg2/extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedFunction: operator does not exist: uuid = text
LINE 4:                     WHERE id = ANY(ARRAY['fb00af4f-e54f-4771...
                                     ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

2026-01-30 11:58:31,765 - INFO - Version: ditwah-v2-per-article
2026-01-30 11:58:31,765 - INFO - Description: Ditwah claims generated from each individual article (min 5 articles per claim, with sentiment + stance)
2026-01-30 11:58:31,765 - INFO - Analysis type: ditwah_claims
2026-01-30 11:58:31,765 - INFO - Min articles per claim: 5
2026-01-30 11:58:31,765 - INFO - LLM provider: mistral
2026-01-30 11:58:31,765 - INFO - LLM model: mistral-large-latest
2026-01-30 11:58:31,765 - INFO - 
Starting BATCHED claims generation pipeline...
2026-01-30 11:58:31,765 - INFO - This will:
2026-01-30 11:58:31,766 - INFO -   1. Process articles in batches of 50
2026-01-30 11:58:31,766 - INFO -   2. Generate claims from each batch
2026-01-30 11:58:31,766 - INFO -   3. Merge and deduplicate claims
2026-01-30 11:58:31,766 - INFO -   4. Filter claims with < 5 articles
2026-01-30 11:58:31,766 - INFO -   5. Analyze sentiment and stance for all claims
2026-01-30 11:58:31,766 - INFO -   6. Keep only claims with BOTH sentiment and stance data

2026-01-30 11:58:31,775 - INFO - Starting batched Ditwah claims pipeline for version ef6bf730-8ab4-4089-8c86-45a4ef9a09b6
2026-01-30 11:58:31,880 - INFO - Found 1657 Ditwah articles
2026-01-30 11:58:31,885 - INFO - Processing 1657 Ditwah articles in batches
2026-01-30 11:58:33,203 - INFO - Processing batch 1/34 (50 articles)...
2026-01-30 11:59:05,877 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:59:05,880 - INFO -   Batch 1: Extracted 26 claims
2026-01-30 11:59:05,880 - INFO - Processing batch 2/34 (50 articles)...
2026-01-30 11:59:32,454 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 11:59:32,458 - INFO -   Batch 2: Extracted 25 claims
2026-01-30 11:59:32,458 - INFO - Processing batch 3/34 (50 articles)...
2026-01-30 12:00:01,088 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:00:01,090 - INFO -   Batch 3: Extracted 25 claims
2026-01-30 12:00:01,091 - INFO - Processing batch 4/34 (50 articles)...
2026-01-30 12:00:35,395 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:00:35,398 - INFO -   Batch 4: Extracted 26 claims
2026-01-30 12:00:35,398 - INFO - Processing batch 5/34 (50 articles)...
2026-01-30 12:01:08,288 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:01:08,290 - INFO -   Batch 5: Extracted 27 claims
2026-01-30 12:01:08,290 - INFO - Processing batch 6/34 (50 articles)...
2026-01-30 12:01:40,599 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:01:40,603 - INFO -   Batch 6: Extracted 30 claims
2026-01-30 12:01:40,603 - INFO - Processing batch 7/34 (50 articles)...
2026-01-30 12:02:14,968 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:02:14,970 - INFO -   Batch 7: Extracted 26 claims
2026-01-30 12:02:14,970 - INFO - Processing batch 8/34 (50 articles)...
2026-01-30 12:02:47,964 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:02:47,966 - INFO -   Batch 8: Extracted 30 claims
2026-01-30 12:02:47,966 - INFO - Processing batch 9/34 (50 articles)...
2026-01-30 12:03:25,435 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:03:25,439 - INFO -   Batch 9: Extracted 28 claims
2026-01-30 12:03:25,439 - INFO - Processing batch 10/34 (50 articles)...
2026-01-30 12:03:59,386 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:03:59,389 - INFO -   Batch 10: Extracted 25 claims
2026-01-30 12:03:59,389 - INFO - Processing batch 11/34 (50 articles)...
2026-01-30 12:04:29,179 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:04:29,181 - INFO -   Batch 11: Extracted 24 claims
2026-01-30 12:04:29,181 - INFO - Processing batch 12/34 (50 articles)...
2026-01-30 12:05:02,648 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:05:02,650 - INFO -   Batch 12: Extracted 27 claims
2026-01-30 12:05:02,650 - INFO - Processing batch 13/34 (50 articles)...
2026-01-30 12:05:31,618 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:05:31,634 - INFO -   Batch 13: Extracted 29 claims
2026-01-30 12:05:31,634 - INFO - Processing batch 14/34 (50 articles)...
2026-01-30 12:06:06,530 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:06:06,532 - INFO -   Batch 14: Extracted 32 claims
2026-01-30 12:06:06,532 - INFO - Processing batch 15/34 (50 articles)...
2026-01-30 12:06:45,324 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:06:45,328 - INFO -   Batch 15: Extracted 37 claims
2026-01-30 12:06:45,328 - INFO - Processing batch 16/34 (50 articles)...
2026-01-30 12:07:17,418 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:07:17,420 - INFO -   Batch 16: Extracted 30 claims
2026-01-30 12:07:17,420 - INFO - Processing batch 17/34 (50 articles)...
2026-01-30 12:07:49,117 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:07:49,410 - INFO -   Batch 17: Extracted 32 claims
2026-01-30 12:07:49,410 - INFO - Processing batch 18/34 (50 articles)...
2026-01-30 12:08:21,139 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:08:21,141 - INFO -   Batch 18: Extracted 32 claims
2026-01-30 12:08:21,141 - INFO - Processing batch 19/34 (50 articles)...
2026-01-30 12:08:47,594 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:08:47,596 - INFO -   Batch 19: Extracted 25 claims
2026-01-30 12:08:47,596 - INFO - Processing batch 20/34 (50 articles)...
2026-01-30 12:09:20,993 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:09:20,995 - INFO -   Batch 20: Extracted 29 claims
2026-01-30 12:09:20,996 - INFO - Processing batch 21/34 (50 articles)...
2026-01-30 12:09:56,308 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:09:56,311 - INFO -   Batch 21: Extracted 27 claims
2026-01-30 12:09:56,311 - INFO - Processing batch 22/34 (50 articles)...
2026-01-30 12:10:29,554 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:10:29,558 - INFO -   Batch 22: Extracted 25 claims
2026-01-30 12:10:29,558 - INFO - Processing batch 23/34 (50 articles)...
2026-01-30 12:11:02,138 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:11:02,140 - INFO -   Batch 23: Extracted 25 claims
2026-01-30 12:11:02,141 - INFO - Processing batch 24/34 (50 articles)...
2026-01-30 12:11:40,349 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:11:40,352 - INFO -   Batch 24: Extracted 35 claims
2026-01-30 12:11:40,353 - INFO - Processing batch 25/34 (50 articles)...
2026-01-30 12:12:11,699 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:12:11,703 - INFO -   Batch 25: Extracted 29 claims
2026-01-30 12:12:11,703 - INFO - Processing batch 26/34 (50 articles)...
2026-01-30 12:12:37,373 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:12:37,376 - INFO -   Batch 26: Extracted 25 claims
2026-01-30 12:12:37,377 - INFO - Processing batch 27/34 (50 articles)...
2026-01-30 12:13:02,439 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:13:02,443 - INFO -   Batch 27: Extracted 26 claims
2026-01-30 12:13:02,443 - INFO - Processing batch 28/34 (50 articles)...
2026-01-30 12:13:35,217 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:13:35,220 - INFO -   Batch 28: Extracted 27 claims
2026-01-30 12:13:35,220 - INFO - Processing batch 29/34 (50 articles)...
2026-01-30 12:14:05,646 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:14:05,648 - INFO -   Batch 29: Extracted 24 claims
2026-01-30 12:14:05,648 - INFO - Processing batch 30/34 (50 articles)...
2026-01-30 12:14:32,401 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:14:32,403 - INFO -   Batch 30: Extracted 26 claims
2026-01-30 12:14:32,403 - INFO - Processing batch 31/34 (50 articles)...
2026-01-30 12:14:57,565 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:14:57,569 - INFO -   Batch 31: Extracted 25 claims
2026-01-30 12:14:57,569 - INFO - Processing batch 32/34 (50 articles)...
2026-01-30 12:15:28,738 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:15:28,740 - INFO -   Batch 32: Extracted 28 claims
2026-01-30 12:15:28,740 - INFO - Processing batch 33/34 (50 articles)...
2026-01-30 12:16:08,208 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:16:08,210 - INFO -   Batch 33: Extracted 30 claims
2026-01-30 12:16:08,210 - INFO - Processing batch 34/34 (7 articles)...
2026-01-30 12:16:18,453 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:16:18,455 - INFO -   Batch 34: Extracted 15 claims
2026-01-30 12:16:18,455 - INFO - ✅ Generated 932 raw claims from 34 batches
2026-01-30 12:16:18,456 - INFO - Merging 932 claims...
2026-01-30 12:16:18,460 - INFO - Merged to 928 unique claims
2026-01-30 12:16:23,003 - INFO - Note: NumExpr detected 12 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2026-01-30 12:16:23,003 - INFO - NumExpr defaulting to 8 threads.
2026-01-30 12:16:25,692 - INFO - Deduplicating 928 claims with embeddings (threshold=0.85)...
/home/ranushi/anaconda3/lib/python3.11/site-packages/torch/cuda/__init__.py:182: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 804: forward compatibility was attempted on non supported HW (Triggered internally at /pytorch/c10/cuda/CUDAFunctions.cpp:119.)
  return torch._C._cuda_getDeviceCount() > 0
2026-01-30 12:16:25,750 - INFO - Use pytorch device_name: cpu
2026-01-30 12:16:25,750 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2026-01-30 12:16:30,241 - INFO - Processing 164 claims in category: infrastructure_damage
2026-01-30 12:16:30,967 - INFO -   Category infrastructure_damage: 164 → 128 claims
2026-01-30 12:16:30,967 - INFO - Processing 134 claims in category: casualties_and_displacement
2026-01-30 12:16:31,350 - INFO -   Category casualties_and_displacement: 134 → 60 claims
2026-01-30 12:16:31,350 - INFO - Processing 165 claims in category: government_response
2026-01-30 12:16:31,847 - INFO -   Category government_response: 165 → 150 claims
2026-01-30 12:16:31,847 - INFO - Processing 206 claims in category: international_response
2026-01-30 12:16:32,457 - INFO -   Category international_response: 206 → 157 claims
2026-01-30 12:16:32,457 - INFO - Processing 158 claims in category: humanitarian_aid
2026-01-30 12:16:33,122 - INFO -   Category humanitarian_aid: 158 → 134 claims
2026-01-30 12:16:33,123 - INFO - Processing 101 claims in category: economic_impact
2026-01-30 12:16:33,760 - INFO -   Category economic_impact: 101 → 91 claims
2026-01-30 12:16:33,760 - INFO - Deduplicated to 720 unique claims
2026-01-30 12:16:33,760 - INFO - Filtered 720 claims to 39 claims with >=5 articles
2026-01-30 12:16:33,760 - INFO - ✅ 39 claims passed filters
2026-01-30 12:16:33,795 - INFO - Stored 39 claims
2026-01-30 12:16:33,799 - INFO - Analyzing claim 1/39: Cyclone Ditwah intensified from a deep depression near Sri L...
2026-01-30 12:16:33,861 - INFO -   Sentiment: 12 records
2026-01-30 12:16:45,224 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:16:55,998 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:17:02,653 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:17:02,701 - INFO -   Stance: 12 records
2026-01-30 12:17:02,701 - INFO - Analyzing claim 2/39: Cyclone Ditwah caused very heavy rainfall exceeding 200 mm i...
2026-01-30 12:17:02,771 - INFO -   Sentiment: 9 records
2026-01-30 12:17:15,265 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:17:24,879 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:17:24,916 - INFO -   Stance: 9 records
2026-01-30 12:17:24,916 - INFO - Analyzing claim 3/39: Strong winds of 60 to 70 km/h, gusting up to 80–90 km/h, wer...
2026-01-30 12:17:24,977 - INFO -   Sentiment: 6 records
2026-01-30 12:17:34,565 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:17:37,930 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:17:37,963 - INFO -   Stance: 6 records
2026-01-30 12:17:37,963 - INFO - Analyzing claim 4/39: Three houses were completely damaged and 431 houses partiall...
2026-01-30 12:17:38,035 - INFO -   Sentiment: 9 records
2026-01-30 12:17:47,455 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:17:57,275 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:17:57,308 - INFO -   Stance: 9 records
2026-01-30 12:17:57,308 - INFO - Analyzing claim 5/39: Cyclone Ditwah was expected to approach the Tamil Nadu coast...
2026-01-30 12:17:57,361 - INFO -   Sentiment: 8 records
2026-01-30 12:18:08,807 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:18:15,468 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:18:15,515 - INFO -   Stance: 8 records
2026-01-30 12:18:15,515 - INFO - Analyzing claim 6/39: Cyclone Ditwah caused severe flooding and landslides, disrup...
2026-01-30 12:18:15,588 - INFO -   Sentiment: 17 records
2026-01-30 12:18:33,960 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:18:46,240 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:18:59,643 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:19:05,264 - INFO - HTTP Request: POST https://api.mistral.ai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-30 12:19:05,299 - ERROR - Pipeline failed with error: insert or update on table "claim_stance" violates foreign key constraint "claim_stance_article_id_fkey"
DETAIL:  Key (article_id)=(bcb1b575-12e1-45d2-bc22-fbd454c69cb5) is not present in table "news_articles".
Traceback (most recent call last):
  File "/home/ranushi/Taf_claude/sl-newspaper-bias-analysis/scripts/ditwah_claims/04_generate_claims_batched.py", line 81, in main
    summary = generate_claims_pipeline_batched(version_id, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ranushi/Taf_claude/sl-newspaper-bias-analysis/src/ditwah_claims_batched.py", line 608, in generate_claims_pipeline_batched
    count = store_claim_stance(claim_id, stance_records)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ranushi/Taf_claude/sl-newspaper-bias-analysis/src/ditwah_claims_batched.py", line 451, in store_claim_stance
    cur.execute(f"""
  File "/home/ranushi/anaconda3/lib/python3.11/site-packages/psycopg2/extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.ForeignKeyViolation: insert or update on table "claim_stance" violates foreign key constraint "claim_stance_article_id_fkey"
DETAIL:  Key (article_id)=(bcb1b575-12e1-45d2-bc22-fbd454c69cb5) is not present in table "news_articles".

